service: product-service

frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs16.x
  role: arn:aws:iam::581741678738:role/DynamoDBLambdaAccessRole
  stage: dev
  region: eu-west-1

plugins:
  - serverless-auto-swagger
  - serverless-webpack
  - serverless-offline

custom:
  apiBaseUrl: https://xuhosefi2j.execute-api.eu-west-1.amazonaws.com/dev
  webpack:
    webpackConfig: 'webpack.config.js'
    includeModules: true
    packager: npm

  swagger:
    basePath: /dev
    info:
      title: Products API
      version: 1.0.0
    host: https://xuhosefi2j.execute-api.eu-west-1.amazonaws.com/dev

functions:
  getProductList:
    handler: src/handler.getProductList
    environment:
      PRODUCT_TABLE_NAME: PRODUCTS_DATA_TABLE
      STOCK_TABLE_NAME: STOCK_TABLE
    events:
      - http:
          path: products
          method: get
          cors: true

  getProductById:
    handler: src/handler.getProductById
    environment:
      PRODUCT_TABLE_NAME: PRODUCTS_DATA_TABLE
    events:
      - http:
          path: products/{productId}
          method: get
          cors: false

  createProduct:
    handler: src/handler.createProduct
    environment:
      PRODUCT_TABLE_NAME: PRODUCTS_DATA_TABLE
    events:
      - http:
          path: products
          method: post
          cors: false